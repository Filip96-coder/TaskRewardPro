# ğŸ›ï¸ Diagramas de Arquitectura - TaskRewardPro

## ğŸ“ Arquitectura General del Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CAPA DE PRESENTACIÃ“N                      â”‚
â”‚                         (Frontend - React)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚     Login     â”‚  â”‚   Register    â”‚  â”‚   Dashboard   â”‚      â”‚
â”‚  â”‚   (pÃºblico)   â”‚  â”‚   (pÃºblico)   â”‚  â”‚  (protegido)  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  TaskRegister â”‚  â”‚   Recompensas â”‚  â”‚    Ranking    â”‚      â”‚
â”‚  â”‚  (protegido)  â”‚  â”‚  (protegido)  â”‚  â”‚  (protegido)  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              AuthContext (Estado Global)                 â”‚   â”‚
â”‚  â”‚  - user, login, register, logout                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           API Services (services/api.js)                 â”‚   â”‚
â”‚  â”‚  - Todas las llamadas HTTP al backend                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ HTTP/REST (JSON)
                             â”‚ Authorization: Bearer <token>
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CAPA DE APLICACIÃ“N                         â”‚
â”‚                    (Backend - Node.js/Express)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    RUTAS (Routes)                        â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  /api/auth/*        â†’ authRoutes                        â”‚   â”‚
â”‚  â”‚  /api/tasks/*       â†’ tareaRoutes                       â”‚   â”‚
â”‚  â”‚  /api/usuarios/*    â†’ usuarioRoutes                     â”‚   â”‚
â”‚  â”‚  /api/recompensas/* â†’ recompensaRoutes                  â”‚   â”‚
â”‚  â”‚  /api/rankings/*    â†’ rankingRoutes                     â”‚   â”‚
â”‚  â”‚  /api/metas/*       â†’ metaRoutes                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚                                    â”‚
â”‚                             â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   MIDDLEWARE                             â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  â€¢ authRequired      â†’ Valida JWT token                 â”‚   â”‚
â”‚  â”‚  â€¢ requireRol        â†’ Valida rol del usuario           â”‚   â”‚
â”‚  â”‚  â€¢ upload            â†’ Maneja subida de archivos        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚                                    â”‚
â”‚                             â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  CONTROLADORES                           â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  â€¢ authController       â†’ Login, Register, Me           â”‚   â”‚
â”‚  â”‚  â€¢ tareaController      â†’ CRUD de Tareas                â”‚   â”‚
â”‚  â”‚  â€¢ submissionController â†’ GestiÃ³n de Entregas           â”‚   â”‚
â”‚  â”‚  â€¢ usuarioController    â†’ CRUD de Usuarios              â”‚   â”‚
â”‚  â”‚  â€¢ recompensaController â†’ CRUD de Recompensas           â”‚   â”‚
â”‚  â”‚  â€¢ rankingController    â†’ GestiÃ³n de Rankings           â”‚   â”‚
â”‚  â”‚  â€¢ metaController       â†’ GestiÃ³n de Metas              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚                                    â”‚
â”‚                             â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    MODELOS (Mongoose)                    â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  â€¢ Usuario (base)    â†’ Admin, Trabajador (discriminators)â”‚  â”‚
â”‚  â”‚  â€¢ Tarea             â†’ Tareas del sistema               â”‚   â”‚
â”‚  â”‚  â€¢ Submission        â†’ Entregas de trabajadores         â”‚   â”‚
â”‚  â”‚  â€¢ Recompensa        â†’ Premios disponibles              â”‚   â”‚
â”‚  â”‚  â€¢ HistorialCanje    â†’ Registro de canjes               â”‚   â”‚
â”‚  â”‚  â€¢ Meta              â†’ Objetivos del equipo             â”‚   â”‚
â”‚  â”‚  â€¢ Ranking           â†’ Posiciones de usuarios           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Mongoose ODM
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CAPA DE PERSISTENCIA                        â”‚
â”‚                        (MongoDB Database)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Colecciones:                                                    â”‚
â”‚  â€¢ usuarios          â†’ Todos los usuarios (con discriminator)   â”‚
â”‚  â€¢ tareas            â†’ Tareas del sistema                       â”‚
â”‚  â€¢ submissions       â†’ Entregas de tareas                       â”‚
â”‚  â€¢ recompensas       â†’ CatÃ¡logo de premios                      â”‚
â”‚  â€¢ historialcanjes   â†’ Log de canjes                            â”‚
â”‚  â€¢ metas             â†’ Objetivos                                â”‚
â”‚  â€¢ rankings          â†’ Clasificaciones                          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SISTEMA DE ARCHIVOS                         â”‚
â”‚                                                                  â”‚
â”‚  /uploads/submissions/   â†’ Archivos de evidencia de tareas      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Diagrama de Flujo: Ciclo Completo de una Tarea

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FASE 1: CREACIÃ“N DE TAREA                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   [ADMIN]
      â”‚
      â”‚ Completa formulario
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TaskRegister â”‚
â”‚   (React)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ POST /api/tasks
       â”‚ { title, description, points, dueDate }
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ authRequired     â”‚ âœ“ Valida token JWT
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ requireRol(Admin)â”‚ âœ“ Valida rol = "Admin"
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ crearTarea()     â”‚ â€¢ Crea documento en BD
â”‚ (Controller)     â”‚ â€¢ status: "Pendiente"
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Tarea Model    â”‚ Guarda en MongoDB
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 201 Created
       â–¼
   [Respuesta]
   { _id, title, description, points, status: "Pendiente" }


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                FASE 2: TRABAJADOR SUBE EVIDENCIA                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   [TRABAJADOR]
      â”‚
      â”‚ Selecciona archivo (PDF, imagen)
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Upload Form  â”‚
â”‚   (React)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ POST /api/tasks/:id/submit
       â”‚ FormData { file: archivo.pdf }
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ authRequired         â”‚ âœ“ Valida token JWT
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚requireRol(Trabajador)â”‚ âœ“ Valida rol = "Trabajador"
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ upload.single("file")â”‚ â€¢ Guarda en /uploads/submissions/
â”‚  (Multer)            â”‚ â€¢ Valida tipo y tamaÃ±o
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ submitTask()         â”‚ â€¢ Elimina entregas previas
â”‚ (Controller)         â”‚ â€¢ Crea nuevo Submission
â”‚                      â”‚   - status: "Pendiente"
â”‚                      â”‚   - claimed: false
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Submission Model     â”‚ Guarda en MongoDB
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 201 Created
       â–¼
   [Respuesta]
   { _id, task, user, status: "Pendiente", filePath }


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 FASE 3: ADMIN REVISA Y DECIDE                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   [ADMIN]
      â”‚
      â”‚ Ve lista de entregas pendientes
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/tasks/  â”‚
â”‚ :id/submissions  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Lista de Submissions con status "Pendiente"
       â–¼
   [ADMIN revisa archivo]
      â”‚
      â”‚ Decide: approve o reject
      â”‚ Escribe feedback (opcional)
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Decision Form    â”‚
â”‚   (React)        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ PATCH /api/tasks/:taskId/submission/:subId/decision
       â”‚ { action: "approve", feedback: "Excelente" }
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ authRequired         â”‚ âœ“ Valida token JWT
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ requireRol(Admin)    â”‚ âœ“ Valida rol = "Admin"
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ decideSubmission()   â”‚ SI action = "approve":
â”‚ (Controller)         â”‚   â€¢ Submission.status = "Aprobada"
â”‚                      â”‚   â€¢ Tarea.status = "Completada"
â”‚                      â”‚ SI action = "reject":
â”‚                      â”‚   â€¢ Submission.status = "Rechazada"
â”‚                      â”‚   â€¢ Tarea.status = "Pendiente"
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Models actualizados  â”‚ Guarda cambios en MongoDB
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 200 OK
       â–¼
   [Respuesta]
   { ok: true, submission: { status: "Aprobada", feedback } }


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                FASE 4: TRABAJADOR RECLAMA PUNTOS                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   [TRABAJADOR]
      â”‚
      â”‚ Ve tarea con status "Aprobada"
      â”‚ BotÃ³n: "Reclamar puntos"
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Claim Button     â”‚
â”‚   (React)        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ POST /api/tasks/:taskId/claim
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ authRequired         â”‚ âœ“ Valida token JWT
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚requireRol(Trabajador)â”‚ âœ“ Valida rol = "Trabajador"
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ claimPoints()        â”‚ 1. Busca Submission aprobada
â”‚ (Controller)         â”‚ 2. Valida claimed = false
â”‚                      â”‚ 3. Obtiene puntos de Tarea
â”‚                      â”‚ 4. Suma puntos a Usuario
â”‚                      â”‚ 5. Marca Submission.claimed = true
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Usuario.points       â”‚ Usuario.points += Tarea.points
â”‚ actualizado          â”‚ Ejemplo: 0 â†’ 100
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Submission.claimed   â”‚ claimed: true
â”‚ actualizado          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 200 OK
       â–¼
   [Respuesta]
   { ok: true, claimed: true, message: "Puntos reclamados" }


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  FASE 5: CANJE DE RECOMPENSA                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   [TRABAJADOR]
      â”‚
      â”‚ Ve sus puntos: 100
      â”‚ Ve recompensas disponibles
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/recompensas â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Lista de recompensas
       â”‚ [
       â”‚   { nombre: "Almuerzo", puntosRequeridos: 75 },
       â”‚   { nombre: "DÃ­a libre", puntosRequeridos: 200 }
       â”‚ ]
       â–¼
   [TRABAJADOR selecciona "Almuerzo" (75 pts)]
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/canjes       â”‚ (endpoint a implementar)
â”‚ { recompensaId }       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Validar puntos         â”‚ Usuario.points >= Recompensa.puntosRequeridos
â”‚                        â”‚ 100 >= 75 âœ“
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Restar puntos          â”‚ Usuario.points = 100 - 75 = 25
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Crear HistorialCanje   â”‚ {
â”‚                        â”‚   usuario: userId,
â”‚                        â”‚   recompensa: recompensaId,
â”‚                        â”‚   fechaCanje: Date.now()
â”‚                        â”‚ }
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Actualizar Recompensa  â”‚ cantidadCanjes++
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 201 Created
       â–¼
   [Respuesta]
   { ok: true, puntosRestantes: 25 }
```

---

## ğŸ—„ï¸ Diagrama de Base de Datos (Relaciones)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      USUARIOS                                   â”‚
â”‚  _id, name, email, password (hash), rol, points, timestamps    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚ createdBy                                 â”‚ user
      â”‚ (1:N)                                     â”‚ (1:N)
      â”‚                                           â”‚
      â–¼                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     TAREAS      â”‚                    â”‚      SUBMISSIONS        â”‚
â”‚  _id            â”‚                    â”‚  _id                    â”‚
â”‚  title          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  task (ref: Tarea)      â”‚
â”‚  description    â”‚        task        â”‚  user (ref: Usuario)    â”‚
â”‚  dueDate        â”‚       (N:1)        â”‚  filePath               â”‚
â”‚  points         â”‚                    â”‚  originalName           â”‚
â”‚  attachments[]  â”‚                    â”‚  mimeType               â”‚
â”‚  createdBy      â”‚                    â”‚  size                   â”‚
â”‚  status         â”‚                    â”‚  status                 â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚  feedback               â”‚
      â”‚                                â”‚  claimed                â”‚
      â”‚ tareas[]                       â”‚  timestamps             â”‚
      â”‚ (N:M)                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      METAS      â”‚
â”‚  _id            â”‚
â”‚  metaId         â”‚
â”‚  nombreMeta     â”‚
â”‚  descripcion    â”‚
â”‚  estado         â”‚
â”‚  tareas[]       â”‚ (array de ObjectId)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      USUARIOS                                   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚ usuario                               â”‚ usuarios[]
      â”‚ (1:N)                                 â”‚ (N:M)
      â”‚                                       â”‚
      â–¼                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HISTORIAL CANJES   â”‚              â”‚    RANKINGS     â”‚
â”‚  _id                â”‚              â”‚  _id            â”‚
â”‚  historialId        â”‚              â”‚  rankingId      â”‚
â”‚  usuario            â”‚              â”‚  usuarios[]     â”‚
â”‚  recompensa         â”‚              â”‚  posicion       â”‚
â”‚  fechaCanje         â”‚              â”‚  fechaActualizadaâ”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚ recompensa
      â”‚ (N:1)
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    RECOMPENSAS      â”‚
â”‚  _id                â”‚
â”‚  nombre             â”‚
â”‚  descripcion        â”‚
â”‚  puntosRequeridos   â”‚
â”‚  cantidadCanjes     â”‚
â”‚  limiteCanjes       â”‚
â”‚  fechaLimiteCanje   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


HERENCIA CON DISCRIMINATORS:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      USUARIO        â”‚
â”‚  (base model)       â”‚
â”‚  - name             â”‚
â”‚  - email            â”‚
â”‚  - password         â”‚
â”‚  - rol              â”‚
â”‚  - points           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                     â”‚
       â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ADMIN    â”‚      â”‚   TRABAJADOR     â”‚
â”‚ (extends)   â”‚      â”‚   (extends)      â”‚
â”‚             â”‚      â”‚   + cargo        â”‚
â”‚             â”‚      â”‚   + puntos       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Nota: Ambos se guardan en la colecciÃ³n "usuarios"
con campo __t que indica el discriminator
```

---

## ğŸ” Diagrama de Flujo: AutenticaciÃ³n JWT

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FLUJO DE REGISTRO                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Usuario] â†’ Completa formulario
            (name, email, password, rol)
              â”‚
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  React   â”‚ POST /api/auth/register
         â”‚  Form    â”‚ { name, email, password, rol }
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ authController â”‚
     â”‚   .register()  â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 1. Valida datos
          â”‚ 2. Verifica email no existe
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    bcrypt    â”‚ hash(password, 10)
     â”‚   .hash()    â”‚ â†’ "$2b$10$...hashed..."
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   Usuario    â”‚ create({
     â”‚   .create()  â”‚   name, email,
     â”‚              â”‚   password: hash,
     â”‚              â”‚   rol, points: 0
     â”‚              â”‚ })
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚     JWT      â”‚ sign({
     â”‚   .sign()    â”‚   id, email, rol
     â”‚              â”‚ }, SECRET, { expiresIn: "7d" })
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ token = "eyJhbGciOi..."
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   Response   â”‚ 201 Created
     â”‚              â”‚ {
     â”‚              â”‚   token: "eyJhbGci...",
     â”‚              â”‚   user: { id, name, email, rol, points }
     â”‚              â”‚ }
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  localStorage    â”‚ setItem("token", token)
     â”‚                  â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   AuthContext    â”‚ setUser(user)
     â”‚                  â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
     [ Redirige a /app/dashboard ]


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FLUJO DE LOGIN                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Usuario] â†’ Ingresa credenciales
            (email, password)
              â”‚
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  React   â”‚ POST /api/auth/login
         â”‚  Form    â”‚ { email, password }
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ authController â”‚
     â”‚    .login()    â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 1. Busca usuario por email
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   Usuario    â”‚ findOne({ email })
     â”‚  .findOne()  â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ user encontrado
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    bcrypt    â”‚ compare(password, user.password)
     â”‚  .compare()  â”‚ â†’ true/false
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ SI coincide
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚     JWT      â”‚ sign({
     â”‚   .sign()    â”‚   id, email, rol
     â”‚              â”‚ }, SECRET, { expiresIn: "7d" })
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ token generado
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   Response   â”‚ 200 OK
     â”‚              â”‚ {
     â”‚              â”‚   token: "eyJhbGci...",
     â”‚              â”‚   user: { id, name, email, role, points }
     â”‚              â”‚ }
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  localStorage    â”‚ setItem("token", token)
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   AuthContext    â”‚ setUser(user)
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
     [ Redirige a /app/dashboard ]


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FLUJO DE PETICIÃ“N AUTENTICADA                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Usuario autenticado] â†’ Hace acciÃ³n (ej: crear tarea)
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    React     â”‚ POST /api/tasks
                    â”‚              â”‚ Headers: {
                    â”‚              â”‚   Authorization: "Bearer eyJh..."
                    â”‚              â”‚ }
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  authRequired   â”‚ (middleware)
                â”‚  (middleware)   â”‚
                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ 1. Lee header Authorization
                     â”‚ 2. Extrae token
                     â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚     JWT      â”‚ verify(token, SECRET)
                â”‚  .verify()   â”‚
                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ SI vÃ¡lido: payload = { id, email, rol }
                     â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  req.user    â”‚ = payload
                â”‚              â”‚ { id, email, rol }
                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ next()
                     â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ requireRol(Admin)â”‚ (middleware)
                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ Compara req.user.rol === "Admin"
                     â”‚
                     â”‚ SI coincide: next()
                     â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ crearTarea() â”‚ (controller)
                â”‚              â”‚ req.user.id disponible
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Token JWT decodificado:

HEADER:
{
  "alg": "HS256",
  "typ": "JWT"
}

PAYLOAD:
{
  "id": "507f1f77bcf86cd799439011",
  "email": "juan@example.com",
  "rol": "Admin",
  "iat": 1706097600,
  "exp": 1706702400
}

SIGNATURE:
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  JWT_SECRET
)
```

---

## ğŸ“ Estructura de Archivos del Proyecto

```
TaskRewardPro/
â”‚
â”œâ”€â”€ Back/                              # Backend (Node.js + Express)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â””â”€â”€ db.js                  # ConexiÃ³n a MongoDB
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ controllers/               # LÃ³gica de negocio
â”‚   â”‚   â”‚   â”œâ”€â”€ authController.js      # Login, register, me
â”‚   â”‚   â”‚   â”œâ”€â”€ historialCanjeController.js
â”‚   â”‚   â”‚   â”œâ”€â”€ metaController.js
â”‚   â”‚   â”‚   â”œâ”€â”€ rankingController.js
â”‚   â”‚   â”‚   â”œâ”€â”€ recompensaController.js
â”‚   â”‚   â”‚   â”œâ”€â”€ submissionController.js # Entregas de tareas
â”‚   â”‚   â”‚   â”œâ”€â”€ tareaController.js     # CRUD de tareas
â”‚   â”‚   â”‚   â””â”€â”€ usuariocontroller.js
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ middleware/                # Funciones intermedias
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.js                # authRequired (valida JWT)
â”‚   â”‚   â”‚   â”œâ”€â”€ rolmiddleware.js       # requireRol (valida rol)
â”‚   â”‚   â”‚   â””â”€â”€ upload.js              # Multer config (archivos)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ models/                    # Esquemas de Mongoose
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.js               # Discriminator de Usuario
â”‚   â”‚   â”‚   â”œâ”€â”€ historialCanje.js
â”‚   â”‚   â”‚   â”œâ”€â”€ meta.js
â”‚   â”‚   â”‚   â”œâ”€â”€ ranking.js
â”‚   â”‚   â”‚   â”œâ”€â”€ recompensa.js
â”‚   â”‚   â”‚   â”œâ”€â”€ submission.js          # Entregas de tareas
â”‚   â”‚   â”‚   â”œâ”€â”€ tarea.js
â”‚   â”‚   â”‚   â”œâ”€â”€ trabajador.js          # Discriminator de Usuario
â”‚   â”‚   â”‚   â””â”€â”€ usuario.js             # Modelo base
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ routes/                    # DefiniciÃ³n de endpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ authRoutes.js          # /api/auth/*
â”‚   â”‚   â”‚   â”œâ”€â”€ historialCanjeRoutes.js
â”‚   â”‚   â”‚   â”œâ”€â”€ metaRoutes.js
â”‚   â”‚   â”‚   â”œâ”€â”€ rankingRoutes.js
â”‚   â”‚   â”‚   â”œâ”€â”€ recompensaRoutes.js
â”‚   â”‚   â”‚   â”œâ”€â”€ tareaRoutes.js         # /api/tasks/*
â”‚   â”‚   â”‚   â””â”€â”€ usuarioRoutes.js
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ index.js                   # Entry point del servidor
â”‚   â”‚
â”‚   â”œâ”€â”€ uploads/                       # Archivos subidos
â”‚   â”‚   â””â”€â”€ submissions/               # Evidencias de tareas
â”‚   â”‚
â”‚   â”œâ”€â”€ .env                           # Variables de entorno
â”‚   â”œâ”€â”€ package.json                   # Dependencias backend
â”‚   â””â”€â”€ index.js                       # Alias a src/index.js
â”‚
â”œâ”€â”€ Front/                             # Frontend (React + Vite)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/                # Componentes reutilizables
â”‚   â”‚   â”‚   â”œâ”€â”€ ProtectedRoute.jsx     # Guard de rutas privadas
â”‚   â”‚   â”‚   â””â”€â”€ Sidebar.jsx            # MenÃº lateral
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ context/                   # Estado global
â”‚   â”‚   â”‚   â””â”€â”€ AuthContext.jsx        # AutenticaciÃ³n global
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ pages/                     # PÃ¡ginas/Vistas
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx          # Panel principal
â”‚   â”‚   â”‚   â”œâ”€â”€ Login.jsx              # Inicio de sesiÃ³n
â”‚   â”‚   â”‚   â”œâ”€â”€ Register.jsx           # Registro de usuarios
â”‚   â”‚   â”‚   â””â”€â”€ TaskRegister.jsx       # Crear tarea
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ services/                  # LÃ³gica de API
â”‚   â”‚   â”‚   â””â”€â”€ api.js                 # Todas las llamadas HTTP
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ App.jsx                    # Componente raÃ­z, rutas
â”‚   â”‚   â”œâ”€â”€ main.jsx                   # Entry point de React
â”‚   â”‚   â””â”€â”€ styles.css                 # Estilos globales
â”‚   â”‚
â”‚   â”œâ”€â”€ public/                        # Archivos estÃ¡ticos
â”‚   â”‚   â”œâ”€â”€ logo-taskreward.png
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ .env                           # Variables de entorno
â”‚   â”œâ”€â”€ index.html                     # HTML base
â”‚   â”œâ”€â”€ package.json                   # Dependencias frontend
â”‚   â””â”€â”€ vite.config.js                 # ConfiguraciÃ³n de Vite
â”‚
â”œâ”€â”€ public/                            # ImÃ¡genes del README
â”‚   â”œâ”€â”€ logo-taskreward.png
â”‚   â”œâ”€â”€ VistaAdmin.png
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ README.md                          # DocumentaciÃ³n principal
```

---

## ğŸ­ Diagrama de Roles y Permisos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ROLES                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   USUARIO   â”‚
                    â”‚   (base)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚               â”‚               â”‚
           â–¼               â–¼               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  ADMIN  â”‚    â”‚  LIDER  â”‚    â”‚TRABAJADORâ”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                PERMISOS POR ROL                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         ADMIN                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                               â•‘
â•‘  TAREAS:                                                      â•‘
â•‘    âœ… POST   /api/tasks              â†’ Crear tarea           â•‘
â•‘    âœ… GET    /api/tasks              â†’ Listar todas          â•‘
â•‘    âœ… PUT    /api/tasks/:id          â†’ Actualizar tarea      â•‘
â•‘    âœ… DELETE /api/tasks/:id          â†’ Eliminar tarea        â•‘
â•‘                                                               â•‘
â•‘  ENTREGAS:                                                    â•‘
â•‘    âœ… GET    /api/tasks/:id/submissions â†’ Ver entregas       â•‘
â•‘    âœ… PATCH  /api/tasks/.../decision    â†’ Aprobar/Rechazar   â•‘
â•‘                                                               â•‘
â•‘  USUARIOS:                                                    â•‘
â•‘    âœ… POST   /api/usuarios           â†’ Crear usuario         â•‘
â•‘    âœ… GET    /api/usuarios           â†’ Listar usuarios       â•‘
â•‘    âœ… PUT    /api/usuarios/:id       â†’ Actualizar usuario    â•‘
â•‘    âœ… DELETE /api/usuarios/:id       â†’ Eliminar usuario      â•‘
â•‘                                                               â•‘
â•‘  RECOMPENSAS:                                                 â•‘
â•‘    âœ… POST   /api/recompensas        â†’ Crear recompensa      â•‘
â•‘    âœ… GET    /api/recompensas        â†’ Listar recompensas    â•‘
â•‘    âœ… PUT    /api/recompensas/:id    â†’ Actualizar recompensa â•‘
â•‘    âœ… DELETE /api/recompensas/:id    â†’ Eliminar recompensa   â•‘
â•‘                                                               â•‘
â•‘  METAS Y RANKINGS:                                            â•‘
â•‘    âœ… Acceso completo a CRUD                                  â•‘
â•‘                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                       TRABAJADOR                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                               â•‘
â•‘  TAREAS:                                                      â•‘
â•‘    âœ… GET    /api/tasks/user/list    â†’ Ver mis tareas        â•‘
â•‘    âŒ POST   /api/tasks              â†’ Crear tarea           â•‘
â•‘    âŒ PUT    /api/tasks/:id          â†’ Actualizar tarea      â•‘
â•‘    âŒ DELETE /api/tasks/:id          â†’ Eliminar tarea        â•‘
â•‘                                                               â•‘
â•‘  ENTREGAS:                                                    â•‘
â•‘    âœ… POST   /api/tasks/:id/submit   â†’ Subir evidencia       â•‘
â•‘    âœ… GET    /api/tasks/:id/submission â†’ Ver mi entrega      â•‘
â•‘    âœ… POST   /api/tasks/:id/claim    â†’ Reclamar puntos       â•‘
â•‘    âŒ GET    /api/tasks/:id/submissions â†’ Ver todas          â•‘
â•‘    âŒ PATCH  /api/tasks/.../decision â†’ Aprobar/Rechazar      â•‘
â•‘                                                               â•‘
â•‘  RECOMPENSAS:                                                 â•‘
â•‘    âœ… GET    /api/recompensas        â†’ Ver recompensas       â•‘
â•‘    âœ… POST   /api/canjes (futuro)    â†’ Canjear puntos        â•‘
â•‘    âŒ POST   /api/recompensas        â†’ Crear recompensa      â•‘
â•‘    âŒ PUT    /api/recompensas/:id    â†’ Actualizar            â•‘
â•‘    âŒ DELETE /api/recompensas/:id    â†’ Eliminar              â•‘
â•‘                                                               â•‘
â•‘  RANKINGS:                                                    â•‘
â•‘    âœ… GET    /api/rankings           â†’ Ver posiciones        â•‘
â•‘                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   LIDER (En desarrollo)                       â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                               â•‘
â•‘  Funcionalidad planeada:                                      â•‘
â•‘    - Ver tareas de su equipo                                 â•‘
â•‘    - Aprobar entregas de su equipo                           â•‘
â•‘    - Ver reportes de su equipo                               â•‘
â•‘    - Crear metas para su equipo                              â•‘
â•‘                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ImplementaciÃ³n en cÃ³digo:

router.post(
  "/api/tasks",
  authRequired,           // â† Todos los usuarios autenticados
  requireRol("Admin"),    // â† Solo Admin
  crearTarea
)

router.post(
  "/api/tasks/:id/submit",
  authRequired,           // â† Todos los usuarios autenticados
  requireRol("Trabajador"), // â† Solo Trabajador
  upload.single("file"),
  submitTask
)
```

---

## ğŸ”„ Diagrama de Estados: Tarea y Submission

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ESTADOS DE TAREA                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   PENDIENTE   â”‚ â† Estado inicial al crear
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Trabajador sube evidencia
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   PENDIENTE   â”‚ â† Esperando aprobaciÃ³n
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                  â”‚
            â”‚ Admin aprueba    â”‚ Admin rechaza
            â–¼                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  COMPLETADA   â”‚  â”‚   PENDIENTE   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ Trabajador reenvÃ­a
                               â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   PENDIENTE   â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ESTADOS DE SUBMISSION (Entrega)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  (No existe)  â”‚ â† Sin submission
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Trabajador sube archivo
                    â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   PENDIENTE   â”‚ â† Esperando revisiÃ³n admin
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                  â”‚
                    â”‚ Admin aprueba    â”‚ Admin rechaza
                    â–¼                  â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   APROBADA    â”‚  â”‚   RECHAZADA   â”‚
            â”‚               â”‚  â”‚               â”‚
            â”‚ claimed:false â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                    â”‚                  â”‚
                    â”‚ Trabajador       â”‚ Trabajador
                    â”‚ reclama puntos   â”‚ sube nuevo archivo
                    â–¼                  â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
            â”‚   APROBADA    â”‚          â”‚
            â”‚               â”‚          â”‚
            â”‚ claimed:true  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ (No puede volver a reclamar)
                    â–¼
                  [FIN]


Estados de Submission:
â€¢ PENDIENTE  â†’ Admin debe revisar
â€¢ APROBADA   â†’ Admin aprobÃ³, puntos disponibles para reclamar
â€¢ RECHAZADA  â†’ Admin rechazÃ³, trabajador puede reenviar

Campo adicional en APROBADA:
â€¢ claimed: false â†’ Puntos NO reclamados aÃºn
â€¢ claimed: true  â†’ Puntos YA reclamados
```

---

## ğŸ“Š Diagrama de Secuencia Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SECUENCIA: Trabajador completa tarea y obtiene puntos      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Trabajador    Frontend      Backend       Middleware   Controller    Database
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
    â”‚ Login       â”‚            â”‚               â”‚            â”‚            â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚               â”‚            â”‚            â”‚
    â”‚             â”‚ POST /api/auth/login       â”‚            â”‚            â”‚
    â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚            â”‚            â”‚
    â”‚             â”‚            â”‚ authController.login()     â”‚            â”‚
    â”‚             â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ findOne    â”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚  bcrypt.compare()       â”‚
    â”‚             â”‚            â”‚               â”‚  jwt.sign()             â”‚
    â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ { token }  â”‚               â”‚            â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
    â”‚ Guarda tokenâ”‚            â”‚               â”‚            â”‚            â”‚
    â”‚ en localStorage          â”‚               â”‚            â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
    â”œâ”€ Navega a lista de tareas                             â”‚            â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚               â”‚            â”‚            â”‚
    â”‚             â”‚ GET /api/tasks/user/list   â”‚            â”‚            â”‚
    â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚            â”‚            â”‚
    â”‚             â”‚            â”œâ”€ authRequired â”€>â”‚          â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚ verify JWT â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚ req.user=payload        â”‚
    â”‚             â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
    â”‚             â”‚            â”œâ”€ requireRol(Trabajador) â”€â”€>â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
    â”‚             â”‚            â”‚ obtenerTareasUsuario()     â”‚            â”‚
    â”‚             â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ find tareasâ”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚            â”‚find submissions
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ [tareas con mySubmission]  â”‚            â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
    â”œâ”€ Selecciona tarea        â”‚               â”‚            â”‚            â”‚
    â”œâ”€ Sube archivo PDF        â”‚               â”‚            â”‚            â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚               â”‚            â”‚            â”‚
    â”‚             â”‚ POST /api/tasks/:id/submit â”‚            â”‚            â”‚
    â”‚             â”‚ FormData(file)             â”‚            â”‚            â”‚
    â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚            â”‚            â”‚
    â”‚             â”‚            â”œâ”€ authRequired â”€>â”‚          â”‚            â”‚
    â”‚             â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
    â”‚             â”‚            â”œâ”€ requireRol(Trabajador) â”€â”€>â”‚            â”‚
    â”‚             â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
    â”‚             â”‚            â”œâ”€ upload.single("file") â”€â”€â”€>â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚ Guarda archivo en disco â”‚
    â”‚             â”‚            â”‚               â”‚ req.file={...}          â”‚
    â”‚             â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
    â”‚             â”‚            â”‚ submitTask()  â”‚            â”‚            â”‚
    â”‚             â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ deleteMany â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ (prev sub) â”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚            â”‚ create     â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ Submission â”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚            â”‚ update     â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ Tarea      â”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 201 { submission }         â”‚            â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
    â”‚ "Entrega en revisiÃ³n"    â”‚               â”‚            â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
    â”œâ”€ [ADMIN APRUEBA] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
Adminâ”‚            â”‚            â”‚               â”‚            â”‚            â”‚
    â”‚ Revisa      â”‚            â”‚               â”‚            â”‚            â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚               â”‚            â”‚            â”‚
    â”‚             â”‚ PATCH /api/tasks/:taskId/submission/:subId/decision â”‚
    â”‚             â”‚ { action: "approve" }      â”‚            â”‚            â”‚
    â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚            â”‚            â”‚
    â”‚             â”‚            â”œâ”€ authRequired â”€>â”‚          â”‚            â”‚
    â”‚             â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
    â”‚             â”‚            â”œâ”€ requireRol(Admin) â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
    â”‚             â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
    â”‚             â”‚            â”‚ decideSubmission()         â”‚            â”‚
    â”‚             â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ findOne    â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ Submission â”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚            â”‚ update     â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ status:    â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ "Aprobada" â”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚            â”‚ update     â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ Tarea      â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ status:    â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ "Completada"â”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 200 { ok: true }           â”‚            â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
Trabajador        â”‚            â”‚               â”‚            â”‚            â”‚
    â”‚ Ve "Aprobada - Reclamar puntos"          â”‚            â”‚            â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚               â”‚            â”‚            â”‚
    â”‚             â”‚ POST /api/tasks/:taskId/claim          â”‚            â”‚
    â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚            â”‚            â”‚
    â”‚             â”‚            â”œâ”€ authRequired â”€>â”‚          â”‚            â”‚
    â”‚             â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
    â”‚             â”‚            â”œâ”€ requireRol(Trabajador) â”€â”€>â”‚            â”‚
    â”‚             â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚            â”‚
    â”‚             â”‚            â”‚ claimPoints() â”‚            â”‚            â”‚
    â”‚             â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ findOne    â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ Submission â”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚            â”‚ validate:  â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ claimed=falseâ”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ findById   â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ Tarea      â”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚            â”‚ findById   â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ Usuario    â”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚            â”‚ update     â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ Usuario.   â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ points +=  â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ Tarea.pointsâ”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚            â”‚               â”‚            â”‚ update     â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ Submission.â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚ claimed:trueâ”‚
    â”‚             â”‚            â”‚               â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 200 { ok: true, claimed: true }        â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
    â”‚ "Â¡100 puntos reclamados!"                â”‚            â”‚            â”‚
    â”‚             â”‚            â”‚               â”‚            â”‚            â”‚
```

---

Â¡Con estos diagramas tendrÃ¡s una visualizaciÃ³n clara de cÃ³mo funciona TaskRewardPro! ğŸš€
